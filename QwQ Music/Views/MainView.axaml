<Grid RowDefinitions="40,*"
      xmlns="https://github.com/avaloniaui"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:viewModels="clr-namespace:QwQ_Music.ViewModels"
      xmlns:u="https://irihi.tech/ursa"
      mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
      Margin="10,0" ColumnDefinitions="Auto,*" ColumnSpacing="10"
      x:DataType="viewModels:MainViewModel"
      x:Class="QwQ_Music.Views.MainView">

    <StackPanel Grid.ColumnSpan="2" Orientation="Horizontal" Margin="10,0" Spacing="20">

        <!-- 标题文本 -->
        <TextBlock FontWeight="Bold"
                   HorizontalAlignment="Left"
                   IsHitTestVisible="False"
                   Text="QwQ Music"
                   VerticalAlignment="Center">

            <TextBlock.Foreground>
                <LinearGradientBrush EndPoint="100%,100%" StartPoint="0%,0%">
                    <GradientStop Color="#FFF02FC2" Offset="0" />
                    <GradientStop Color="#FF6094EA" Offset="1" />
                </LinearGradientBrush>
            </TextBlock.Foreground>

            <TextBlock.Effect>
                <DropShadowEffect Color="Black" Opacity="0.1" />
            </TextBlock.Effect>

        </TextBlock>

        <StackPanel Orientation="Horizontal" Spacing="10">

            <StackPanel.Styles>

                <Style Selector="Button">
                    <Setter Property="Height" Value="25" />
                    <Setter Property="Width" Value="25" />
                    <Setter Property="Padding" Value="6" />
                    <Setter Property="VerticalAlignment" Value="Center" />
                    <Setter Property="CornerRadius" Value="15" />
                </Style>

            </StackPanel.Styles>

            <Button Classes="Icon" Command="{Binding ViewBackwardCommand}">
                <PathIcon Data="{StaticResource Forward}" />
            </Button>

            <Button Classes="Icon" Command="{Binding ViewForwardCommand}">
                <PathIcon RenderTransform="rotate(180deg)"
                          Data="{StaticResource Forward}" />
            </Button>

        </StackPanel>

    </StackPanel>


    <Grid Grid.Row="1" Grid.Column="0" HorizontalAlignment="Left"
          RowDefinitions="Auto,*"
          Width="{Binding DrawerStatusViewModel.NavigationWidth}">

        <Grid.Transitions>
            <Transitions>
                <DoubleTransition
                    Duration="0:0:0.5"
                    Easing="CircularEaseOut"
                    Property="Width" />
            </Transitions>
        </Grid.Transitions>

        <!-- 折叠/展开菜单栏按钮 -->
        <ToggleButton HorizontalAlignment="Right"
                      IsChecked="{Binding DrawerStatusViewModel.IsNavigationExpand}"
                      CornerRadius="30"
                      Height="35"
                      Width="35"
                      Margin="10,0"
                      BorderThickness="0">

            <ToggleButton.Styles>

                <Style Selector="ToggleButton">
                    <Setter Property="Background" Value="Transparent" />

                    <Style Selector="^:checked /template/ ContentPresenter">
                        <Setter Property="Background" Value="Transparent" />
                        <Setter Property="Foreground" Value="{DynamicResource ButtonDefaultPrimaryForeground}" />
                        <Setter Property="RenderTransform" Value="rotate(180deg)" />
                    </Style>

                    <Style Selector="^:checked:pointerover /template/ ContentPresenter">
                        <Setter Property="Background"
                                Value="{DynamicResource ButtonDefaultPointeroverBackground}" />
                    </Style>

                    <Style Selector="^:checked:pressed  /template/ ContentPresenter">
                        <Setter Property="Background"
                                Value="{DynamicResource ButtonDefaultPressedBackground}" />
                    </Style>

                </Style>

                <Style Selector="ToggleButton /template/ ContentPresenter">
                    <Setter Property="Transitions">
                        <Transitions>
                            <TransformOperationsTransition Duration="0:0:0.2" Property="RenderTransform" />
                        </Transitions>
                    </Setter>

                </Style>
            </ToggleButton.Styles>

            <PathIcon Data="{StaticResource SemiIconChevronRight}" Height="10" Width="10" />

            <ToolTip.Tip>
                <Panel>
                    <TextBlock IsVisible="{Binding !$parent[ToggleButton].IsChecked}" Text="展开导航栏" />
                    <TextBlock IsVisible="{Binding $parent[ToggleButton].IsChecked}" Text="收起导航栏" />
                </Panel>
            </ToolTip.Tip>

        </ToggleButton>

        <ScrollViewer Grid.Row="1">

            <u:SelectionList SelectedIndex="{Binding NavigationIndex}">

                <u:SelectionList.Indicator>
                    <Border Effect="{DynamicResource LightColorDropShadowEffect}"
                            Background="{DynamicResource SemiBlue5}"
                            Classes.Expanded="{Binding DrawerStatusViewModel.IsNavigationExpand}"
                            CornerRadius="8">
                        <Border.Transitions>
                            <Transitions>
                                <TransformOperationsTransition
                                    Duration="0:0:0.3"
                                    Easing="CircularEaseOut"
                                    Property="RenderTransform" />
                            </Transitions>
                        </Border.Transitions>

                    </Border>
                </u:SelectionList.Indicator>

                <u:SelectionList.Styles>

                    <Style Selector="Border.Expanded">
                        <Setter Property="RenderTransform" Value="scale(1.1,1)" />
                    </Style>

                    <Style Selector="u|SelectionListItem">
                        <Setter Property="Height" Value="35" />
                        <Setter Property="Margin" Value="10" />
                        <Setter Property="Padding" Value="10" />
                        <Setter Property="Transitions">
                            <Transitions>
                                <BrushTransition Duration="0:0:0.3" Property="Foreground" />
                                <TransformOperationsTransition Duration="0:0:0.3" Property="RenderTransform" />
                            </Transitions>
                        </Setter>

                        <Style Selector="^:selected">
                            <Setter Property="Foreground" Value="White" />
                            <Setter Property="RenderTransform" Value="scale(1.1)" />
                        </Style>
                    </Style>

                    <Style Selector="u|SelectionList > StackPanel">
                        <Setter Property="Spacing" Value="10" />
                        <Setter Property="Orientation" Value="Horizontal" />
                    </Style>

                    <Style Selector="u|SelectionList > StackPanel > TextBlock">
                        <Setter Property="VerticalAlignment" Value="Center" />
                        <Setter Property="Opacity" Value="0" />
                        <Setter Property="Transitions">
                            <Transitions>
                                <DoubleTransition
                                    Duration="0:0:0.5"
                                    Easing="CircularEaseOut"
                                    Property="Opacity" />
                            </Transitions>
                        </Setter>
                    </Style>

                    <Style Selector="TextBlock.NotTransparent">
                        <Setter Property="Opacity" Value="1" />
                    </Style>

                </u:SelectionList.Styles>

                <u:SelectionList.Styles>

                    <Style Selector="Grid">
                        <Setter Property="ColumnSpacing" Value="10" />
                    </Style>

                    <Style Selector="Grid > TextBlock">
                        <Setter Property="VerticalAlignment" Value="Center" />
                        <Setter Property="Transitions">
                            <Transitions>
                                <DoubleTransition
                                    Duration="0:0:0.5"
                                    Easing="CircularEaseOut"
                                    Property="Opacity" />
                            </Transitions>
                        </Setter>
                    </Style>

                    <Style Selector="TextBlock.Transparent">
                        <Setter Property="Opacity" Value="0" />
                    </Style>

                </u:SelectionList.Styles>

                <Grid ColumnDefinitions="Auto,*">
                    <PathIcon Data="{StaticResource SemiIconSong}" />
                    <TextBlock Grid.Column="1" Text="{Binding MusicName}"
                               Classes.Transparent="{Binding !DrawerStatusViewModel.IsNavigationExpand}" />
                </Grid>

                <Grid ColumnDefinitions="Auto,*">
                    <PathIcon Data="{StaticResource SemiIconDisc}" />
                    <TextBlock Grid.Column="1" Text="{Binding ClassificationName}"
                               Classes.Transparent="{Binding !DrawerStatusViewModel.IsNavigationExpand}" />
                </Grid>

                <Grid ColumnDefinitions="Auto,*">
                    <PathIcon Data="{StaticResource SemiIconBox}" />
                    <TextBlock Grid.Column="1" Text="{Binding OtherName}"
                               Classes.Transparent="{Binding !DrawerStatusViewModel.IsNavigationExpand}" />
                </Grid>

                <Grid ColumnDefinitions="Auto,*">
                    <PathIcon Data="{StaticResource SemiIconSetting}" />
                    <TextBlock Grid.Column="1" Text="{Binding SettingsName}"
                               Classes.Transparent="{Binding !DrawerStatusViewModel.IsNavigationExpand}" />
                </Grid>

            </u:SelectionList>

        </ScrollViewer>

    </Grid>

    <Carousel Grid.Row="1" Grid.Column="1" ItemsSource="{Binding Pages}"
              SelectedIndex="{Binding NavigationIndex}">

        <Carousel.PageTransition>
            <CompositePageTransition>
                <CrossFade Duration="0:0:0.5" />
                <PageSlide Duration="0:0:0.3"
                           Orientation="Vertical"
                           SlideInEasing="QuadraticEaseIn"
                           SlideOutEasing="QuadraticEaseOut" />
            </CompositePageTransition>
        </Carousel.PageTransition>

    </Carousel>

    <Interaction.Behaviors>

        <PointerWheelChangedTrigger>
            <InvokeCommandAction Command="{Binding PointerWheelChangedCommand}" PassEventArgsToCommand="True" />
        </PointerWheelChangedTrigger>

    </Interaction.Behaviors>

</Grid>